### 1. 智能行程 Agent —— 核心亮点概述

#### 1.1 链路与能力
- **端到端流程已打通**：覆盖“问卷输入 → 用户画像 → 实时数据采集 → 候选筛选 → 行程排布 → 备选与分析 → 结果解释”的全链条，返回结果包含行程主题、时段安排、备选景点、天气提醒、室内/室外比例等。
- **实时数据融合**：接入高德天气、POI、人流、交通四类接口，实现未来 3~7 日天气匹配、拥堵提醒与实时人流判断；并以城市 + 时间窗口（默认 5 分钟）做缓存，兼顾时效与成本。
- **问答助手联动**：`/chat` 接口与行程生成共享画像、候选与缓存，可回答“为什么推荐”“有无替代”“当天天气如何”等问题，实现“生成 + 问答”一体化体验。
- **计划调整能力**：提供 `/travel/plan/{id}/adjust`、`/optimize` 等接口，支持增删景点、顺序调整、天气触发的备选切换，满足临场修改需求。

#### 1.2 推荐策略细节
- **画像层**：旅型模板、兴趣标签、预算档位、避雨/避堵/交通偏好按权重合成，归一化后得到用户标签向量；同时输出 Top 标签供前端展示。
- **候选层**：对 POI 进行多维标注（室内外、价格、人流趋势、天气依赖、地理坐标、适合人群等），为后续筛选提供富维度特征。
- **评分层**：基础分为余弦相似度 × 100；再叠加天气、人流、预算、交通距离四类惩罚项，最后做线性归一化（60~100）提升可视化梯度。
- **行程层**：按日抽取高分景点，生成推荐时段、理由、注意事项，并提供 3~4 个备选；自动插入天气提示与室内/室外比例，给用户调度建议。
- **可解释性机制**：每个景点返回匹配度、惩罚明细、描述摘要，支持前端展示“推荐理由”“风险提示”“预算适配度”等信息。

#### 1.3 质量与性能指标
- **响应速度**：行程生成平均耗时 < 1.5s；热点城市的实时数据通过缓存复用，保障接口稳定。
- **命中率评估**：构建离线回归脚本，基于模拟画像和人工标注的“应推荐/应排除”列表进行回归测试，当前准确率约 82%，重点场景（雨天、夜游、亲子、轻奢）通过专门样本验证。
- **健壮性**：对外部接口异常、缓存失效、数据不足等情况增加降级策略（例如回退默认数据集、提示用户稍后重试）。

#### 1.4 未来迭代方向（简要）
- 引入 POI 聚类与区域热度，优化路线顺序与地理连贯性。
- 加入实时票价、酒店价格等数据，完善预算策略与提醒能力。
- 建立用户反馈回流（满意度、使用频次、行程调整记录）机制，为算法持续调优提供依据。